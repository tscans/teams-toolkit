{{header}}

projectId: 00000000-0000-0000-0000-000000000000

environmentFolderPath: ./env

# Triggered when 'teamsfx provision' is executed
provision:
{{aadAppCreate}}
{{teamsAppCreate}}
{{armDeploy}}
{{azureStorage}}
{{aadAppUpdate}}
{{teamsAppUpdate}}
{{m365Title}}

# Triggered when 'teamsfx deploy' is executed
deploy:
  # Run npm command
  - uses: cli/runNpmCommand
    name: install tab dependencies
    with:
      workingDirectory: tabs
      args: install
  # Run npm command
  - uses: cli/runNpmCommand
    name: build tab app
    env:
      REACT_APP_CLIENT_ID: $\{{AAD_APP_CLIENT_ID}}
      REACT_APP_START_LOGIN_PAGE_URL: $\{{PROVISIONOUTPUT__AZURESTORAGETABOUTPUT__ENDPOINT}}/auth-start.html
    with:
      workingDirectory: tabs
      args: run build --if-present
  # Deploy bits to Azure Storage Static Website
  - uses: azureStorage/deploy
    with:
      workingDirectory: tabs
      # Deploy base folder. This folder includes manifest files for Microsoft Entra app and Teams app that should be ignored using the ignoreFile.
      artifactFolder: build
      # The resource id of the cloud resource to be deployed to. 
      # This key will be generated by arm/deploy action automatically. 
      # You can replace it with your existing Azure Resource id 
      # or add it to your environment variable file.
      resourceId: $\{{PROVISIONOUTPUT__AZURESTORAGETABOUTPUT__STORAGERESOURCEID}}

# Triggered when 'teamsfx publish' is executed
publish:
{{teamsAppUpdate}}
{{teamsAppPublish}}